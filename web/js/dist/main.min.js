const Cookies={set(n,e,t=null){let i="";if(t&&!isNaN(t)){const o=new Date;o.setTime(o.getTime()+t*24*60*60*1e3),i=`; expires=${o.toUTCString()}`}document.cookie=`${n}=${JSON.stringify(e)}`+i+'; path="/"; SameSite=None; Secure'},read(n){const e=document.cookie.split("; ").find(t=>t.startsWith(`${n}=`))?.split("=")[1];return e?JSON.parse(e):void 0},remove(n){this.set(n,"",-1)}};function randomString(n=16){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=(r,s)=>{if(r<0||r>65535)throw new Error("minimum supported number is 0, this generator can only make numbers between 0-65535 inclusive.");if(s>65535||s<0)throw new Error("max supported number is 65535, this generator can only make numbers between 0-65535 inclusive.");if(r>s)throw new Error("dude min>max wtf");const a=s>255?new Uint16Array(1):new Uint8Array(1);let c,u=0;for(;;){if(crypto.getRandomValues(a),c=a[0],c>=r&&c<=s)return c;if(++u,u>1e6)throw new Error("tried a million times, something is wrong")}};let i=0;const o=new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*\d)[a-zA-Z\d]{8,}$/),l=e.length-1;for(;;){let r="";for(let s=0;s<n;++s)r+=e[t(0,l)];if(o.test(r))return r;if(++i,i>1e6)throw new Error("tried a million times, something is wrong")}}document.addEventListener("alpine:init",()=>{window.addEventListener("scroll",()=>{const e=document.querySelector(".toolbar"),t=e.getBoundingClientRect().top+(window.scrollY-document.documentElement.clientTop),i=document.querySelector(".top-bar").offsetHeight,o=window.scrollY>t-i;e.classList.toggle("active",o)});const n=document.querySelector(".js-toggle-all");n&&n.addEventListener("change",e=>{document.querySelectorAll(".ch-toggle").forEach(t=>t.checked=e.target.checked),document.querySelectorAll(".l-unit").forEach(t=>t.classList.toggle("selected",e.target.checked))}),document.querySelectorAll(".js-unlimited-toggle").forEach(e=>{const t=e.parentElement.querySelector("input");Alpine.store("globals").isUnlimitedValue(t.value)?VE.helpers.enableInputUnlimited(t,e):VE.helpers.disableInputUnlimited(t,e),e.addEventListener("click",()=>{VE.helpers.toggleInputUnlimited(t,e)})}),Alpine.bind("BulkEdit",()=>({"@submit"(e){e.preventDefault(),document.querySelectorAll(".ch-toggle").forEach(t=>{if(t.checked){const i=document.createElement("input");i.type="hidden",i.name=t.name,i.value=t.value,e.target.appendChild(i)}}),e.target.submit()}})),Alpine.store("form",{dirty:!1,makeDirty(){this.dirty=!0}}),document.querySelectorAll("#vstobjects input, #vstobjects select, #vstobjects textarea").forEach(e=>{e.addEventListener("change",()=>{Alpine.store("form").makeDirty()})}),Alpine.data("notifications",()=>({initialized:!1,open:!1,notifications:[],toggle(){this.open=!this.open,this.initialized||this.list()},async list(){const e=document.querySelector("#token").getAttribute("token"),t=await fetch(`/list/notifications/?ajax=1&token=${e}`);if(this.initialized=!0,!t.ok)throw new Error("An error occurred while listing notifications.");this.notifications=Object.entries(await t.json()).reduce((i,[o,l])=>[...i,l],[])},async remove(e){const t=document.querySelector("#token").getAttribute("token");await fetch(`/delete/notification/?delete=1&notification_id=${e}&token=${t}`),this.notifications=this.notifications.filter(i=>i.ID!=e),this.notifications.length==0&&(this.open=!1)},async removeAll(){const e=document.querySelector("#token").getAttribute("token");await fetch(`/delete/notification/?delete=1&token=${e}`),this.notifications=[],this.open=!1}}))});const addNsButton=document.querySelector(".js-add-ns");addNsButton&&addNsButton.addEventListener("click",()=>{const n=document.querySelectorAll("input[name^=v_ns]"),e=n.length;if(e<8){const t=n[0].parentElement.cloneNode(!0),i=t.querySelector("input");i.removeAttribute("value"),i.name=`v_ns${e+1}`,addNsButton.insertAdjacentElement("beforebegin",t)}e===7&&addNsButton.classList.add("u-hidden")}),document.querySelectorAll(".js-remove-ns").forEach(n=>{n.addEventListener("click",()=>{n.parentElement.remove(),document.querySelectorAll("input[name^=v_ns]").forEach((t,i)=>t.name=`v_ns${i+1}`),document.querySelector(".js-add-ns").classList.remove("u-hidden")})}),document.querySelectorAll(".js-confirm-action").forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();const t=n.dataset.confirmTitle,i=n.dataset.confirmMessage,o=n.getAttribute("href");VE.helpers.createConfirmationDialog({title:t,message:i,targetUrl:o})})}),document.querySelectorAll(".js-password-input").forEach(n=>{const e=t=>{clearTimeout(window.frp_usr_tmt),window.frp_usr_tmt=setTimeout(()=>{VE.helpers.recalculatePasswordStrength(t.target)},100)};n.addEventListener("keypress",e),n.addEventListener("input",e)});
