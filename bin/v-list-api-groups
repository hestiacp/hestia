#!/bin/bash
# info: list script groups available to use in web API
# options: [FORMAT]
#
# example: v-list-api-groups json

#----------------------------------------------------------#
#                Variables & Functions                     #
#----------------------------------------------------------#

# Argument definition
format="${1:-shell}"

# Includes
# shellcheck source=/etc/hestiacp/hestia.conf
source /etc/hestiacp/hestia.conf
# shellcheck source=/usr/local/hestia/func/main.sh
source $HESTIA/func/main.sh
# load config file
source_conf "$HESTIA/conf/hestia.conf"

# JSON list function
json_list() {
    echo '{'
    local quote=''
    for group in "${!WEB_API_SCRIPT_GROUPS[@]}"; do
        echo -en "$quote"
        echo -n '    "'$group'": "'${WEB_API_SCRIPT_GROUPS[$group]}'"'
        quote=",\n"
    done
    echo -e '\n}'
}

# SHELL list function
shell_list() {
    list="Group\tScripts\n"
    list+="-----\t-------\n"

    for group in "${!WEB_API_SCRIPT_GROUPS[@]}"; do
        list+="${group}\t${WEB_API_SCRIPT_GROUPS[$group]}\n"
    done
    echo -e "$list" | column -t -s "	"
}

# Listing data
case $format in
    json)   json_list ;;
    shell)  shell_list ;;
esac

#----------------------------------------------------------#
#                       Hestia                             #
#----------------------------------------------------------#

exit
